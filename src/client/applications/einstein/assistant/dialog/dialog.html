<template>
    <template lwc:if={hasError}>
        <slds-information-block class="slds-p-around_x-small" title={error_title} variant="error">
            <p>{error_message}</p>
        </slds-information-block>
    </template>
    <div class="assistant-container slds-fill-height slds-is-relative">
        
        <!-- Prompt Result -->
        <section role="log" class="slds-chat">
            <ul class="slds-chat-list">
                <template for:each={messages} for:item="item">
                    <assistant-message key={item.id} item={item}></assistant-message>
                </template>
                <template lwc:if={isLoading}>
                    <li class="slds-chat-listitem slds-chat-listitem_inbound">
                        <div class="slds-chat-message">
                            <div class="slds-chat-message__body">
                                <div class="slds-chat-message__text slds-chat-message__text_inbound slds-chat-loading">
                                    <span class="slds-icon-typing slds-is-animated" title="Assistant is typing">
                                        <span class="slds-icon-typing__dot"></span>
                                        <span class="slds-icon-typing__dot"></span>
                                        <span class="slds-icon-typing__dot"></span>
                                        <span class="slds-assistive-text">Assistant is typing</span>
                                    </span>
                                    <span aria-hidden="true"> Your Assistant is searching</span>
                                </div>
                            </div>
                        </div>
                    </li>
                </template>
            </ul>
        </section>
        <!-- Prompt Entry -->
        <div class="slds-publisher slds-is-active slds-p-around_small">
            <label for="comment-text-input2" class="slds-publisher__toggle-visibility slds-m-bottom_small">To: Assistant </label>
            <textarea id="comment-text-input2" class="slds-publisher__input slds-textarea slds-text-longform" placeholder="Write a promptâ€¦" onkeydown={handleInputChange} disabled={isLoading}></textarea>
            <div class="slds-publisher__actions slds-grid slds-grid_align-spread">
                <ul class="slds-grid slds-publisher__toggle-visibility">
                    <li>
                        <button class="slds-button slds-button_icon slds-button_icon-container" disabled title="Attach a file">
                            <svg class="slds-button__icon" aria-hidden="true">
                                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#attach"></use>
                            </svg>
                            <span class="slds-assistive-text">Attach a file</span>
                        </button>
                    </li>
                </ul>
                <lightning-button label="Send" variant="brand" onclick={handleSendClick} disabled={isSendButtonDisabled}></lightning-button>
            </div>
        </div>
    </div>
    
</template>